#ifndef FXAA_FRAG_H
#define FXAA_FRAG_H

#ifdef __cplusplus
extern "C" {
#endif

static const char FXAA_FRAG[] = "#version 330 core\nnoperspective in vec2 vTexCoord;uniform sampler2D uTexture;uniform vec2 uTexelSize;\nout vec4 FragColor;\n#define FXAA_PRESET 5\n#if (FXAA_PRESET == 3)\n#define FXAA_EDGE_THRESHOLD (1./8.)\n#define FXAA_EDGE_THRESHOLD_MIN (1./16.)\n#define FXAA_SEARCH_STEPS 16\n#define FXAA_SEARCH_THRESHOLD (1./4.)\n#define FXAA_SUBPIX_CAP (3./4.)\n#define FXAA_SUBPIX_TRIM (1./4.)\n#endif\n#if (FXAA_PRESET == 4)\n#define FXAA_EDGE_THRESHOLD (1./8.)\n#define FXAA_EDGE_THRESHOLD_MIN (1./24.)\n#define FXAA_SEARCH_STEPS 24\n#define FXAA_SEARCH_THRESHOLD (1./4.)\n#define FXAA_SUBPIX_CAP (3./4.)\n#define FXAA_SUBPIX_TRIM (1./4.)\n#endif\n#if (FXAA_PRESET == 5)\n#define FXAA_EDGE_THRESHOLD (1./8.)\n#define FXAA_EDGE_THRESHOLD_MIN (1./24.)\n#define FXAA_SEARCH_STEPS 32\n#define FXAA_SEARCH_THRESHOLD (1./4.)\n#define FXAA_SUBPIX_CAP (3./4.)\n#define FXAA_SUBPIX_TRIM (1./4.)\n#endif\n#define FXAA_SUBPIX_TRIM_SCALE (1./(1. - FXAA_SUBPIX_TRIM))\nfloat FxaaLuma(vec3 rgb){return rgb.y*(.587/.299)+rgb.x;}vec3 FxaaLerp3(vec3 a,vec3 b,float amountOfA){return(vec3(-amountOfA)*b)+((a*vec3(amountOfA))+b);}vec4 FxaaTexOff(sampler2D tex,vec2 pos,ivec2 off,vec2 rcpFrame){float x=pos.x+float(off.x)*rcpFrame.x;float y=pos.y+float(off.y)*rcpFrame.y;return texture(tex,vec2(x,y));}void main(){vec2 pos=vTexCoord;vec3 rgbN=FxaaTexOff(uTexture,pos.xy,ivec2(0,-1),uTexelSize).xyz;vec3 rgbW=FxaaTexOff(uTexture,pos.xy,ivec2(-1,0),uTexelSize).xyz;vec3 rgbM=FxaaTexOff(uTexture,pos.xy,ivec2(0,0),uTexelSize).xyz;vec3 rgbE=FxaaTexOff(uTexture,pos.xy,ivec2(1,0),uTexelSize).xyz;vec3 rgbS=FxaaTexOff(uTexture,pos.xy,ivec2(0,1),uTexelSize).xyz;float lumaN=FxaaLuma(rgbN);float lumaW=FxaaLuma(rgbW);float lumaM=FxaaLuma(rgbM);float lumaE=FxaaLuma(rgbE);float lumaS=FxaaLuma(rgbS);float rangeMin=min(lumaM,min(min(lumaN,lumaW),min(lumaS,lumaE)));float rangeMax=max(lumaM,max(max(lumaN,lumaW),max(lumaS,lumaE)));float range=rangeMax-rangeMin;if(range<max(FXAA_EDGE_THRESHOLD_MIN,rangeMax*FXAA_EDGE_THRESHOLD)){FragColor=vec4(rgbM,1.);return;}vec3 rgbL=rgbN+rgbW+rgbM+rgbE+rgbS;float lumaL=(lumaN+lumaW+lumaE+lumaS)*.25;float rangeL=abs(lumaL-lumaM);float blendL=max(0.,(rangeL/range)-FXAA_SUBPIX_TRIM)*FXAA_SUBPIX_TRIM_SCALE;blendL=min(FXAA_SUBPIX_CAP,blendL);vec3 rgbNW=FxaaTexOff(uTexture,pos.xy,ivec2(-1,-1),uTexelSize).xyz;vec3 rgbNE=FxaaTexOff(uTexture,pos.xy,ivec2(1,-1),uTexelSize).xyz;vec3 rgbSW=FxaaTexOff(uTexture,pos.xy,ivec2(-1,1),uTexelSize).xyz;vec3 rgbSE=FxaaTexOff(uTexture,pos.xy,ivec2(1,1),uTexelSize).xyz;rgbL+=(rgbNW+rgbNE+rgbSW+rgbSE);rgbL*=vec3(1./9.);float lumaNW=FxaaLuma(rgbNW);float lumaNE=FxaaLuma(rgbNE);float lumaSW=FxaaLuma(rgbSW);float lumaSE=FxaaLuma(rgbSE);float edgeVert=abs((.25*lumaNW)+(-.5*lumaN)+(.25*lumaNE))+abs((.50*lumaW)+(-1.*lumaM)+(.50*lumaE))+abs((.25*lumaSW)+(-.5*lumaS)+(.25*lumaSE));float edgeHorz=abs((.25*lumaNW)+(-.5*lumaW)+(.25*lumaSW))+abs((.50*lumaN)+(-1.*lumaM)+(.50*lumaS))+abs((.25*lumaNE)+(-.5*lumaE)+(.25*lumaSE));bool horzSpan=edgeHorz>=edgeVert;float lengthSign=horzSpan?-uTexelSize.y:-uTexelSize.x;if(!horzSpan){lumaN=lumaW;lumaS=lumaE;}float gradientN=abs(lumaN-lumaM);float gradientS=abs(lumaS-lumaM);lumaN=(lumaN+lumaM)*.5;lumaS=(lumaS+lumaM)*.5;if(gradientN<gradientS){lumaN=lumaS;lumaN=lumaS;gradientN=gradientS;lengthSign*=-1.;}vec2 posN;posN.x=pos.x+(horzSpan?0.:lengthSign*.5);posN.y=pos.y+(horzSpan?lengthSign*.5:0.);gradientN*=FXAA_SEARCH_THRESHOLD;vec2 posP=posN;vec2 offNP=horzSpan?vec2(uTexelSize.x,0.):vec2(0.,uTexelSize.y);float lumaEndN=lumaN;float lumaEndP=lumaN;bool doneN=false;bool doneP=false;posN+=offNP*vec2(-1.,-1.);posP+=offNP*vec2(1.,1.);for(int i=0;i<FXAA_SEARCH_STEPS;i++){if(!doneN){lumaEndN=FxaaLuma(texture(uTexture,posN.xy).xyz);}if(!doneP){lumaEndP=FxaaLuma(texture(uTexture,posP.xy).xyz);}doneN=doneN||(abs(lumaEndN-lumaN)>=gradientN);doneP=doneP||(abs(lumaEndP-lumaN)>=gradientN);if(doneN&&doneP){break;}if(!doneN){posN-=offNP;}if(!doneP){posP+=offNP;}}float dstN=horzSpan?pos.x-posN.x:pos.y-posN.y;float dstP=horzSpan?posP.x-pos.x:posP.y-pos.y;bool directionN=dstN<dstP;lumaEndN=directionN?lumaEndN:lumaEndP;if(((lumaM-lumaN)<0.)==((lumaEndN-lumaN)<0.)){lengthSign=0.;}float spanLength=(dstP+dstN);dstN=directionN?dstN:dstP;float subPixelOffset=(.5+(dstN*(-1./spanLength)))*lengthSign;vec3 rgbF=texture(uTexture,vec2(pos.x+(horzSpan?0.:subPixelOffset),pos.y+(horzSpan?subPixelOffset:0.))).xyz;FragColor=vec4(FxaaLerp3(rgbL,rgbF,blendL),1.);}";

#define FXAA_FRAG_SIZE 4393

#ifdef __cplusplus
}
#endif

#endif // FXAA_FRAG_H
